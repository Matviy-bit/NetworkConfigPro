{# Cisco IOS/IOS-XE Configuration Template #}
!
! Generated by NetConfigPro
! Vendor: Cisco IOS/IOS-XE
!
hostname {{ hostname }}
!
{% if enable_secret %}
enable secret {{ enable_secret }}
{% endif %}
{% if domain_name %}
ip domain-name {{ domain_name }}
{% endif %}
!
{% if dns_servers %}
{% for dns in dns_servers %}
ip name-server {{ dns }}
{% endfor %}
{% endif %}
!
{% if ntp_servers %}
{% for ntp in ntp_servers %}
ntp server {{ ntp }}
{% endfor %}
{% endif %}
!
{% if banner_motd %}
banner motd ^
{{ banner_motd }}
^
{% endif %}
!
{# Spanning Tree Configuration #}
{% if stp %}
spanning-tree mode {{ stp.mode.value }}
{% if stp.priority != 32768 %}
spanning-tree vlan 1-4094 priority {{ stp.priority }}
{% endif %}
{% for vlan_id in stp.root_primary_vlans %}
spanning-tree vlan {{ vlan_id }} root primary
{% endfor %}
{% for vlan_id in stp.root_secondary_vlans %}
spanning-tree vlan {{ vlan_id }} root secondary
{% endfor %}
{% if stp.portfast_default %}
spanning-tree portfast default
{% endif %}
{% if stp.bpduguard_default %}
spanning-tree portfast bpduguard default
{% endif %}
!
{% endif %}
{# VLANs #}
{% if vlans %}
{% for vlan in vlans %}
vlan {{ vlan.vlan_id }}
 name {{ vlan.name }}
{% if vlan.description %}
 ! {{ vlan.description }}
{% endif %}
{% if vlan.state != 'active' %}
 state {{ vlan.state }}
{% endif %}
!
{% endfor %}
{% endif %}
!
{# Interfaces #}
{% for iface in interfaces %}
interface {{ iface.name }}
{% if iface.description %}
 description {{ iface.description }}
{% endif %}
{% if not iface.enabled %}
 shutdown
{% else %}
 no shutdown
{% endif %}
{# L2 Switchport Configuration #}
{% if iface.switchport_mode %}
{% if iface.switchport_mode.value == 'access' %}
 switchport mode access
{% if iface.access_vlan %}
 switchport access vlan {{ iface.access_vlan }}
{% endif %}
{% if iface.voice_vlan %}
 switchport voice vlan {{ iface.voice_vlan }}
{% endif %}
{% elif iface.switchport_mode.value == 'trunk' %}
 switchport mode trunk
{% if iface.trunk_native_vlan %}
 switchport trunk native vlan {{ iface.trunk_native_vlan }}
{% endif %}
{% if iface.trunk_allowed_vlans %}
 switchport trunk allowed vlan {{ iface.trunk_allowed_vlans }}
{% endif %}
{% else %}
 switchport mode {{ iface.switchport_mode.value }}
{% endif %}
{% elif iface.is_trunk %}
 switchport mode trunk
{% if iface.native_vlan %}
 switchport trunk native vlan {{ iface.native_vlan }}
{% endif %}
{% if iface.trunk_allowed_vlans %}
 switchport trunk allowed vlan {{ iface.trunk_allowed_vlans }}
{% endif %}
{% elif iface.vlan_id %}
 switchport mode access
 switchport access vlan {{ iface.vlan_id }}
{% endif %}
{# L3 Configuration #}
{% if iface.ip_address and iface.subnet_mask %}
 ip address {{ iface.ip_address }} {{ iface.subnet_mask }}
{% endif %}
{% if iface.speed %}
 speed {{ iface.speed }}
{% endif %}
{% if iface.duplex %}
 duplex {{ iface.duplex }}
{% endif %}
{% if iface.mtu != 1500 %}
 mtu {{ iface.mtu }}
{% endif %}
{% if iface.channel_group %}
 channel-group {{ iface.channel_group }} mode {{ iface.channel_group_mode|default('active') }}
{% endif %}
!
{% endfor %}
!
{# ACLs #}
{% for acl in acls %}
{% if acl.is_extended %}
ip access-list extended {{ acl.name }}
{% else %}
ip access-list standard {{ acl.name }}
{% endif %}
{% for entry in acl.entries %}
{% if entry.remark %}
 {{ entry.sequence }} remark {{ entry.remark }}
{% else %}
 {{ entry.sequence }} {{ entry.action.value }} {{ entry.protocol.value }} {{ entry.source }}{% if entry.source_wildcard != '0.0.0.0' %} {{ entry.source_wildcard }}{% endif %}{% if entry.source_port %} eq {{ entry.source_port }}{% endif %} {{ entry.destination }}{% if entry.destination_wildcard != '0.0.0.0' %} {{ entry.destination_wildcard }}{% endif %}{% if entry.destination_port %} eq {{ entry.destination_port }}{% endif %}{% if entry.log %} log{% endif %}

{% endif %}
{% endfor %}
!
{% endfor %}
!
{# Static Routes #}
{% for route in static_routes %}
ip route {{ route.destination }} {{ route.mask }} {{ route.next_hop }}{% if route.admin_distance != 1 %} {{ route.admin_distance }}{% endif %}{% if route.name %} name {{ route.name }}{% endif %}{% if route.permanent %} permanent{% endif %}

{% endfor %}
!
{# Prefix Lists #}
{% for prefix_list in prefix_lists %}
{% for entry in prefix_list.entries %}
ip prefix-list {{ prefix_list.name }} seq {{ entry.sequence }} {{ entry.action }} {{ entry.prefix }}{% if entry.ge %} ge {{ entry.ge }}{% endif %}{% if entry.le %} le {{ entry.le }}{% endif %}

{% endfor %}
{% endfor %}
!
{# Route Maps #}
{% for route_map in route_maps %}
{% for entry in route_map.entries %}
route-map {{ route_map.name }} {{ entry.action }} {{ entry.sequence }}
{% if entry.match_prefix_list %}
 match ip address prefix-list {{ entry.match_prefix_list }}
{% endif %}
{% if entry.match_as_path %}
 match as-path {{ entry.match_as_path }}
{% endif %}
{% if entry.match_community %}
 match community {{ entry.match_community }}
{% endif %}
{% if entry.set_local_pref %}
 set local-preference {{ entry.set_local_pref }}
{% endif %}
{% if entry.set_med %}
 set metric {{ entry.set_med }}
{% endif %}
{% if entry.set_weight %}
 set weight {{ entry.set_weight }}
{% endif %}
{% if entry.set_as_path_prepend %}
 set as-path prepend {{ entry.set_as_path_prepend }}
{% endif %}
{% if entry.set_community %}
 set community {{ entry.set_community }}
{% endif %}
{% if entry.set_next_hop %}
 set ip next-hop {{ entry.set_next_hop }}
{% endif %}
!
{% endfor %}
{% endfor %}
!
{# OSPF #}
{% if ospf %}
router ospf {{ ospf.process_id }}
{% if ospf.router_id %}
 router-id {{ ospf.router_id }}
{% endif %}
{% if ospf.reference_bandwidth != 100 %}
 auto-cost reference-bandwidth {{ ospf.reference_bandwidth }}
{% endif %}
{% for network in ospf.networks %}
 network {{ network.network }} {{ network.wildcard }} area {{ network.area }}
{% endfor %}
{% for passive in ospf.passive_interfaces %}
 passive-interface {{ passive }}
{% endfor %}
{% if ospf.default_information_originate %}
 default-information originate
{% endif %}
!
{% endif %}
!
{# EIGRP #}
{% if eigrp %}
{% if eigrp.named_mode %}
router eigrp {{ eigrp.name }}
 !
 address-family ipv4 unicast autonomous-system {{ eigrp.as_number }}
  !
{% if eigrp.router_id %}
  eigrp router-id {{ eigrp.router_id }}
{% endif %}
{% for network in eigrp.networks %}
  network {{ network.network }}{% if network.wildcard %} {{ network.wildcard }}{% endif %}

{% endfor %}
{% for passive in eigrp.passive_interfaces %}
  passive-interface {{ passive }}
{% endfor %}
{% for redist in eigrp.redistribute %}
  redistribute {{ redist }}
{% endfor %}
  exit-address-family
{% else %}
router eigrp {{ eigrp.as_number }}
{% if eigrp.router_id %}
 eigrp router-id {{ eigrp.router_id }}
{% endif %}
{% if not eigrp.auto_summary %}
 no auto-summary
{% endif %}
{% for network in eigrp.networks %}
 network {{ network.network }}{% if network.wildcard %} {{ network.wildcard }}{% endif %}

{% endfor %}
{% for passive in eigrp.passive_interfaces %}
 passive-interface {{ passive }}
{% endfor %}
{% for redist in eigrp.redistribute %}
 redistribute {{ redist }}
{% endfor %}
{% endif %}
!
{% endif %}
!
{# BGP #}
{% if bgp %}
router bgp {{ bgp.local_as }}
{% if bgp.router_id %}
 bgp router-id {{ bgp.router_id }}
{% endif %}
{% if bgp.log_neighbor_changes %}
 bgp log-neighbor-changes
{% endif %}
{% for network in bgp.networks %}
 network {{ network }}
{% endfor %}
{% for neighbor in bgp.neighbors %}
 neighbor {{ neighbor.ip_address }} remote-as {{ neighbor.remote_as }}
{% if neighbor.description %}
 neighbor {{ neighbor.ip_address }} description {{ neighbor.description }}
{% endif %}
{% if neighbor.password %}
 neighbor {{ neighbor.ip_address }} password {{ neighbor.password }}
{% endif %}
{% if neighbor.update_source %}
 neighbor {{ neighbor.ip_address }} update-source {{ neighbor.update_source }}
{% endif %}
{% if neighbor.ebgp_multihop > 0 %}
 neighbor {{ neighbor.ip_address }} ebgp-multihop {{ neighbor.ebgp_multihop }}
{% endif %}
{% if neighbor.route_map_in %}
 neighbor {{ neighbor.ip_address }} route-map {{ neighbor.route_map_in }} in
{% endif %}
{% if neighbor.route_map_out %}
 neighbor {{ neighbor.ip_address }} route-map {{ neighbor.route_map_out }} out
{% endif %}
{% endfor %}
!
{% endif %}
!
end
