{# Arista EOS Configuration Template #}
!
! Generated by NetConfigPro
! Vendor: Arista EOS
!
hostname {{ hostname }}
!
{% if enable_secret %}
enable secret sha512 {{ enable_secret }}
{% endif %}
{% if domain_name %}
dns domain {{ domain_name }}
{% endif %}
!
{% if dns_servers %}
{% for dns in dns_servers %}
ip name-server {{ dns }}
{% endfor %}
{% endif %}
!
{% if ntp_servers %}
{% for ntp in ntp_servers %}
ntp server {{ ntp }}
{% endfor %}
{% endif %}
!
{% if banner_motd %}
banner motd
{{ banner_motd }}
EOF
{% endif %}
!
{# VLANs #}
{% if vlans %}
{% for vlan in vlans %}
vlan {{ vlan.vlan_id }}
   name {{ vlan.name }}
{% if vlan.state != 'active' %}
   state {{ vlan.state }}
{% endif %}
!
{% endfor %}
{% endif %}
!
{# Interfaces #}
{% for iface in interfaces %}
interface {{ iface.name }}
{% if iface.description %}
   description {{ iface.description }}
{% endif %}
{% if not iface.enabled %}
   shutdown
{% else %}
   no shutdown
{% endif %}
{% if iface.ip_address and iface.subnet_mask %}
   ip address {{ iface.ip_address }}/{{ iface.subnet_mask | cidr_prefix }}
{% endif %}
{% if iface.is_trunk %}
   switchport mode trunk
{% if iface.native_vlan %}
   switchport trunk native vlan {{ iface.native_vlan }}
{% endif %}
{% if iface.trunk_allowed_vlans %}
   switchport trunk allowed vlan {{ iface.trunk_allowed_vlans }}
{% endif %}
{% elif iface.vlan_id %}
   switchport mode access
   switchport access vlan {{ iface.vlan_id }}
{% endif %}
{% if iface.mtu != 1500 %}
   mtu {{ iface.mtu }}
{% endif %}
{% if iface.channel_group %}
   channel-group {{ iface.channel_group }} mode active
{% endif %}
!
{% endfor %}
!
{# ACLs #}
{% for acl in acls %}
ip access-list {{ acl.name }}
{% for entry in acl.entries %}
{% if entry.remark %}
   remark {{ entry.remark }}
{% else %}
   {{ entry.sequence }} {{ entry.action.value }} {{ entry.protocol.value }} {{ entry.source }}{% if entry.source_wildcard != '0.0.0.0' %}/{{ entry.source_wildcard | cidr_prefix }}{% endif %}{% if entry.source_port %} eq {{ entry.source_port }}{% endif %} {{ entry.destination }}{% if entry.destination_wildcard != '0.0.0.0' %}/{{ entry.destination_wildcard | cidr_prefix }}{% endif %}{% if entry.destination_port %} eq {{ entry.destination_port }}{% endif %}{% if entry.log %} log{% endif %}

{% endif %}
{% endfor %}
!
{% endfor %}
!
{# Static Routes #}
{% for route in static_routes %}
ip route {{ route.destination }}/{{ route.mask | cidr_prefix }} {{ route.next_hop }}{% if route.admin_distance != 1 %} {{ route.admin_distance }}{% endif %}{% if route.name %} name {{ route.name }}{% endif %}

{% endfor %}
!
{# OSPF #}
{% if ospf %}
router ospf {{ ospf.process_id }}
{% if ospf.router_id %}
   router-id {{ ospf.router_id }}
{% endif %}
{% if ospf.reference_bandwidth != 100 %}
   auto-cost reference-bandwidth {{ ospf.reference_bandwidth }}
{% endif %}
{% for passive in ospf.passive_interfaces %}
   passive-interface {{ passive }}
{% endfor %}
{% if ospf.default_information_originate %}
   default-information originate
{% endif %}
{% for network in ospf.networks %}
   network {{ network.network }} {{ network.wildcard }} area {{ network.area }}
{% endfor %}
!
{% endif %}
!
{# BGP #}
{% if bgp %}
router bgp {{ bgp.local_as }}
{% if bgp.router_id %}
   router-id {{ bgp.router_id }}
{% endif %}
{% for neighbor in bgp.neighbors %}
   neighbor {{ neighbor.ip_address }} remote-as {{ neighbor.remote_as }}
{% if neighbor.description %}
   neighbor {{ neighbor.ip_address }} description {{ neighbor.description }}
{% endif %}
{% if neighbor.password %}
   neighbor {{ neighbor.ip_address }} password {{ neighbor.password }}
{% endif %}
{% if neighbor.update_source %}
   neighbor {{ neighbor.ip_address }} update-source {{ neighbor.update_source }}
{% endif %}
{% if neighbor.ebgp_multihop > 0 %}
   neighbor {{ neighbor.ip_address }} ebgp-multihop {{ neighbor.ebgp_multihop }}
{% endif %}
{% if neighbor.route_map_in %}
   neighbor {{ neighbor.ip_address }} route-map {{ neighbor.route_map_in }} in
{% endif %}
{% if neighbor.route_map_out %}
   neighbor {{ neighbor.ip_address }} route-map {{ neighbor.route_map_out }} out
{% endif %}
{% endfor %}
{% for network in bgp.networks %}
   network {{ network }}
{% endfor %}
!
{% endif %}
!
end
